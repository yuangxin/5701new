# 3 实验与评估

## 3.1 实验设置

### 3.1.1 数据集

#### 数据集描述
本研究采用了包含6个样本文本的综合评估数据集，用于验证抄袭检测系统的多维性能。数据集包括中文文本和英文文本，涵盖不同的语言场景和文本特征。

**数据集组成：**
- **中文文本**（4个）：A.txt、B.txt、C.txt、D.txt
  - 用于评估系统在中文文本中的抄袭检测能力
  - 覆盖不同的抄袭模式：直接复制、改写、混合型
  
- **英文文本**（2个）：English1.txt、English2.txt
  - 用于评估系统的跨语言检测能力
  - 验证系统在英文语料库上的性能表现

#### 数据集统计信息

| 指标 | 数值 |
|------|------|
| 总文本数 | 6 |
| 中文文本数 | 4 |
| 英文文本数 | 2 |
| 文本类型 | 混合（中英混合） |

#### 数据处理管道

所有输入文本都经过以下处理流程：

1. **文本加载**
   - 从磁盘逐行读取文本文件
   - 生成句子级别的记录（SentenceRecord），每条记录包含文本ID、句子索引和内容

2. **段落分割**
   - 根据空行将文本分割为多个段落
   - 每个段落进一步按照标点符号（句号、感叹号、问号等）分割为句子
   - 生成段落级别的语义单元用于层次化分析

3. **特征向量化**
   - 采用预训练的句子转换模型（sentence-transformers）进行文本编码
   - 模型：all-MiniLM-L6-v2
   - 输出维度：384维的密集向量表示
   - 支持中英文双语编码，确保跨语言检测的一致性

4. **索引构建**
   - 使用FAISS（Facebook AI Similarity Search）库构建高效的向量索引
   - 索引类型：IVFFlat
   - 支持亚线性时间复杂度的相似性检索

### 3.1.2 系统配置参数

#### 核心检测参数

| 参数名 | 默认值 | 说明 |
|-------|-------|------|
| similarity_threshold | 0.82 | 句子级相似度阈值，用于判定相似句对 |
| para_threshold | 0.75 | 段落级相似度阈值 |
| index_top_k | 5 | 向量索引检索的Top-K值 |
| para_top_k | 3 | 段落级检索的Top-K值 |
| max_hits_per_pair | 50 | 每对文本的最大匹配结果数 |

#### 功能开关配置

| 功能 | 默认状态 | 描述 |
|------|--------|------|
| enable_paragraph_check | 启用 | 段落级层次化检测 |
| enable_citation_check | 启用 | 引用识别与惩罚机制 |
| enable_multilingual | 禁用 | 跨语言检测模式 |
| enable_agent | 禁用 | 智能Agent深度分析 |

#### 模型与硬件配置

| 配置项 | 值 |
|-------|-----|
| 嵌入模型 | all-MiniLM-L6-v2 |
| 模型维度 | 384 |
| 计算设备 | CPU（默认）/ CUDA（可选） |
| 并行处理 | 支持多线程加速（num_workers=2） |
| 向量索引库 | FAISS-CPU |

### 3.1.3 检测模式

#### 模式一：目标文件模式
用户上传一个目标文件（待检测文件）和多个参考文件（对照库），系统只输出目标文件与各参考文件之间的相似性关系。

**优势：**
- 节省计算资源
- 快速获得针对性的检测结果
- 适合单个文档的快速检测

**应用场景：**
- 学生作业检测
- 投稿论文抄袭检测
- 单个文件的风险评估

#### 模式二：全文件比较模式
系统对所有上传的文件进行两两比较，生成完整的相似性矩阵。

**优势：**
- 全面的互相比较
- 发现隐藏的重复关系
- 适合小规模语料库的完整分析

**应用场景：**
- 批量学生作业检测
- 学术数据集的抄袭分析
- 语料库的完整性检查

### 3.1.4 多层次检测机制

#### 句子级检测
- **粒度**：单条句子
- **优势**：精细的定位能力，能精确指出抄袭的具体位置
- **计算方式**：
  - 提取目标句子的384维向量表示
  - 通过FAISS索引检索Top-5相似句子
  - 计算余弦相似度，与阈值（0.82）比较

#### 段落级检测
- **粒度**：多句组成的段落
- **优势**：捕捉上下文结构，判别改写型抄袭
- **计算方式**：
  - 将段落中所有句子的向量进行平均池化
  - 在参考文本的段落级向量库中进行检索
  - 使用段落级阈值（0.75）进行判决

#### 层次化聚合
- 将句子级和段落级的检测结果进行聚合
- 通过双层验证提高检测的准确性和鲁棒性

### 3.1.5 引用识别机制

系统支持对已标注的引用内容进行特殊处理，以区分合法引用与抄袭行为。

#### 引用惩罚策略
- **识别方式**：通过文本中的标记（如方括号、脚注等）识别已标注的引用
- **惩罚机制**：对被标注为引用的文本降低风险评分
- **目的**：鼓励学生进行正确的引用标注

#### 引用可视化
- 在检测报告中用特殊颜色标注识别出的引用部分
- 帮助用户快速区分引用内容与抄袭内容

### 3.1.6 Agent增强分析（可选）

系统集成了智能Agent机制用于高风险案例的深度分析。

#### Agent触发条件
- 系统检测到风险分数超过阈值（默认0.70）的文本对
- 最多分析Top-3个高风险对

#### Agent分析能力
- 语义理解：深度分析文本的语义相似性
- 改写识别：识别同义改写、句式变换等隐蔽抄袭
- 引用判别：区分正常改述与不当抄袭
- 风险评估：生成定量的相似度分数和定性的分析报告

### 3.1.7 输出与报告

系统生成多种格式的检测报告，便于进行详细分析和展示。

#### 报告类型

| 报告类型 | 格式 | 内容 |
|--------|------|------|
| 摘要报告 | CSV | 全局的相似度统计 |
| 配对详情 | CSV | 每一对文件的匹配句子对 |
| 证据展示 | CSV | 相似度最高的证据片段 |
| 单词统计 | CSV | 词级别的重复统计 |
| Web报告 | HTML | 可视化交互式报告（可选） |
| Word报告 | DOCX | Microsoft Word格式的完整报告 |

#### 检测结果三色分级

| 风险等级 | 相似度范围 | 颜色 | 解释 |
|--------|---------|------|------|
| 高风险 | 0.82-1.0 | 红色 | 高度可疑，需要进一步审查 |
| 中风险 | 0.75-0.82 | 黄色 | 中等可疑，可能存在改写 |
| 低风险 | <0.75 | 绿色 | 低度可疑，可能为正常重复 |

### 3.1.8 技术栈

#### 核心依赖库

| 库名 | 版本 | 功能 |
|-----|------|------|
| sentence-transformers | 最新 | 文本向量化编码 |
| faiss-cpu | 最新 | 向量索引与相似搜索 |
| numpy | 最新 | 数值计算 |
| streamlit | 最新 | Web界面框架 |
| openai | 最新 | Agent分析接口 |
| python-docx | 最新 | Word文档生成 |

#### 开发环境

- **编程语言**：Python 3.8+
- **操作系统**：支持Windows、Linux、macOS
- **部署方式**：本地Streamlit应用 / 云端部署可选
- **浏览器支持**：现代浏览器（Chrome、Firefox、Safari等）

---

## 总结

本实验设置通过结合句子级和段落级的多层次检测、智能的向量索引、灵活的配置参数和可视化的报告输出，构建了一个完整的抄袭检测系统。该系统具有高效性、准确性和易用性，适合在学术诚信管理、内容相似性检测等多个领域的应用。
